<div class="staff-service">

    <!--工具栏开始、不打印, 修改wf-tool-bars-url-base -->
    <div wf-tool-bars="wfOperateOpts" wf-tool-bars-url-base="/DirectCommissionedNotProjectApplicationWf" wf-collect-data-fn="collectData"></div>
    <!--工具栏结束-->
    <!--流程导航开始-->
    <div ng-include="'views/common/flow-nav.html'"></div>
    <!--流程导航结束-->
    <!--表单正文开始，打印-->
    <div class="container appil-container">
        <!--页面标题开始-->
        <div class="page-header clearfix">
            <span>{{title}}</span>
            <small>单据编号：{{viewModel.flowNumber}}</small>
        </div>
        <!--页面标题结束-->
        <!--信息项组标题-->
        <h4 class="control-heading bg-info"><i class="glyphicon glyphicon-list-alt"></i>采购信息</h4>
        <div class="form-inline">
            <div class="col-xs-12 col-sm-12 col-md-12 form-group" ng-show="viewModel.purchaseBase.upstreamProcessGuideName">
                <label class="col-xs-6 col-sm-3 col-md-2 control-label" title="上游流程" style="text-align:right;">上游流程</label>
                <div class="col-xs-6 col-sm-9 col-md-10 form-group baseifo-input">
                    <span>{{viewModel.purchaseBase.upstreamProcessGuideName}}</span>
                    <span ng-show="viewModel.purchaseBase.upstreamProcessURL != ''">/</span>
                    <div ng-show="viewModel.purchaseBase.upstreamProcessURL != ''" open-extra-link extra-link="viewModel.purchaseBase.upstreamProcessURL" extra-name="viewModel.purchaseBase.upstreamProcessName"></div>
                </div>
            </div>

            <div class="col-xs-12 col-sm-4 col-md-4 form-group">
                <label class="col-xs-6 control-label" title="是否涉及信息系统建设" style="text-align:right">是否涉及信息系统建设<span style="color:red;">*</span></label>
                <div class="col-xs-6 form-group baseifo-input" sog-valide-status="是否涉及信息系统建设">
                    <div>
                        <input type="radio" ng-click="baseInfo.InitITConstruction(false)" value="false" name="InvolveITConstruction" ng-checked="!viewModel.purchaseOfNotProject.isInvolveITConstruction" />不涉及
                        <input type="radio" ng-click="baseInfo.InitITConstruction(true)" style="margin-left:20px;" value="true" name="InvolveITConstruction" ng-checked="viewModel.purchaseOfNotProject.isInvolveITConstruction" />涉及
                    </div>
                </div>
            </div>
            <div class="clearfix visible-xs-block"></div>

            <div class="col-xs-12 col-sm-8 col-md-8 form-group">
                <span style="color:red;">提示：若涉及信息系统建设业务，请走信息系统建设流程发起采购，否则无法发起合同！</span>
            </div>
            <div class="clearfix visible-xs-block"></div>
            <div class="clearfix"></div>

            <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                <label class="col-xs-6 control-label text-right" title="是否涉及项目">是否涉及项目<span style="color:red;">*</span></label>
                <div class="col-xs-6 form-group baseifo-input">
                    <div>
                        <input type="radio" ng-click="baseInfo.InitProjectInfo(false)" value="false" name="InvolveProject" ng-checked="!viewModel.purchaseOfNotProject.isInvolveProject" />不涉及
                        <input type="radio" ng-click="baseInfo.InitProjectInfo(true)" style="margin-left:20px;" value="true" name="InvolveProject" ng-checked="viewModel.purchaseOfNotProject.isInvolveProject" />涉及
                    </div>
                </div>
            </div>
            <div ng-show="viewModel.purchaseOfNotProject.isInvolveProject">
                <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                    <label class="col-xs-6 control-label text-right" title="项目名称">项目名称<span style="color:red;">*</span></label>
                    <div class="col-xs-6 form-group baseifo-input" sog-valide-status="项目名称">
                        <div rc-select-project opts="settings.projectOpts"></div>
                    </div>
                </div>
            </div>
            <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                <label class="col-xs-6 control-label text-right" title="采购主责人">采购主责人<span style="color:red;">*</span></label>
                <div class="col-xs-6 form-group baseifo-input" sog-valide-status="采购主责人">
                    <span sog-ogu-input="viewModel.purchaseMainUser" opts="baseInfo.peopleSelect"></span>
                </div>
            </div>
            <div class="clearfix"></div>

            <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                <label class="col-xs-6 control-label text-right" title="支出类型">
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true" title="本项目支出：正常的合同签订方式，是指本项目/本单位使用，并在本项目/本单位列支；
跨项目列支：是指A项目使用的费用，要在B项目列支；
平台在项目列支：是指集团或者事业部平台使用的费用，要在项目上列支；
若事业部平台和项目共用记账公司，平台发生费用时需选择“平台在项目列支”，否则无法选到正确的成本中心；" style="color:red"></span>
                    支出类型<span style="color:red;">*</span>
                </label>
                <div class="col-xs-6 form-group baseifo-input">
                    <select sog-valide-status="支出类型" style="width:100%;" class="meeting" ng-model="viewModel.purchaseBase.expenditureTypeCode" ng-options="p.code as p.name for p in viewModel.options.expenditureTypeList" ng-selected="p.code == viewModel.purchaseBase.expenditureTypeCode" ng-change="baseInfo.expenditureTypeChange();">
                        <option value="">--请选择--</option>
                    </select>
                </div>
            </div>
            <div class="clearfix"></div>

            <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                <label class="col-xs-6 control-label" title="法人公司" style="text-align:right">法人公司<span style="color:red;">*</span></label>
                <div class="col-xs-6 form-group baseifo-input">
                    <div select-corporation data="viewModel.corporationScopeList" opts="settings.corporationOpts"></div>
                </div>
            </div>
            <div class="clearfix visible-xs-block"></div>

            <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                <label class="col-xs-6 control-label" title="指合同的列支记账公司" style="text-align:right" ng-show="viewModel.isUseCostCenter">记账公司<span style="color:red;">*</span></label>
                <label class="col-xs-6 control-label" title="记账公司" style="text-align:right" ng-show="!viewModel.isUseCostCenter">记账公司<span style="color:red;">*</span></label>
                <div class="col-xs-6 form-group baseifo-input">
                    <select sog-valide-status="记账公司" style="width:100%;" class="meeting" ng-model="viewModel.purchaseOfNotProject.chargeCompanyCode" ng-change="baseInfo.chargeCompanyChange();" ng-options="p.code as p.name for p in viewModel.options.chargeCompany" ng-selected="p.code == viewModel.purchaseOfNotProject.chargeCompanyCode">
                        <option value="">--请选择--</option>
                    </select>
                </div>
            </div>
            <div class="clearfix visible-xs-block"></div>

            <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                <label class="col-xs-6 control-label" title="指合同的列支成本中心" style="text-align:right" ng-show="viewModel.isUseCostCenter">成本中心<span style="color:red;">*</span></label>
                <label class="col-xs-6 control-label" title="成本中心" style="text-align:right" ng-show="!viewModel.isUseCostCenter">成本中心<span style="color:red;">*</span></label>
                <div class="col-xs-6 form-group baseifo-input">
                    <select sog-valide-status="成本中心" style="width:100%;" class="meeting" ng-model="viewModel.purchaseOfNotProject.costCenterCode" ng-change="baseInfo.costCenterChange();" ng-options="p.code as p.name for p in viewModel.options.costCenter" ng-selected="p.code == viewModel.purchaseOfNotProject.costCenterCode">
                        <option value="">--请选择--</option>
                    </select>
                </div>
            </div>
            <div class="clearfix visible-xs-block"></div>
            <div class="clearfix"></div>

            <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                <label class="col-xs-6 control-label text-right" title="是否重大诉讼">是否重大诉讼<span style="color:red;">*</span></label>
                <div class="col-xs-6 form-group baseifo-input" sog-valide-status="是否重大诉讼">
                    <div>
                        <input type="radio" ng-click="baseInfo.InitIsGreatLawsuit(true)" style="margin-left:20px;" value="true" name="IsGreatLawsuit" ng-checked="viewModel.purchaseOfNotProject.isGreatLawsuit==true" />是
                        <input type="radio" ng-click="baseInfo.InitIsGreatLawsuit(false)" value="false" name="IsGreatLawsuit" ng-checked="viewModel.purchaseOfNotProject.isGreatLawsuit==false" />否
                    </div>
                </div>
            </div>
            <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                <label class="col-xs-6 control-label text-right" title="是否法务类">是否法务类<span style="color:red;">*</span></label>
                <div class="col-xs-6 form-group baseifo-input" sog-valide-status="是否法务类">
                    <div ng-if="!viewModel.isUpstreamReadOnly">
                        <input type="radio" ng-click="baseInfo.InitIsLegal(true)" style="margin-left:20px;" value="true" name="IsLegal" ng-checked="viewModel.purchaseOfNotProject.isLegal==true" />是
                        <input type="radio" ng-click="baseInfo.InitIsLegal(false)" value="false" name="IsLegal" ng-checked="viewModel.purchaseOfNotProject.isLegal==false" />否
                    </div>
                    <div ng-if="viewModel.isUpstreamReadOnly">
                        <span ng-if="viewModel.purchaseOfNotProject.isLegal">是</span>
                        <span ng-if="!viewModel.purchaseOfNotProject.isLegal">否</span>
                    </div>
                </div>
            </div>
            <div class="clearfix"></div>

            <div class="clearfix visible-xs-block"></div>
            <div class="col-xs-12 col-sm-12 col-md-12 form-group">
                <label class="col-xs-6 col-sm-3  col-md-2 control-label" title="采购名称" style="text-align:right;">采购名称<span style="color:red;">*</span></label>
                <div class="col-xs-6 col-sm-9 col-md-10 form-group baseifo-input">
                    <input sog-valide-status="采购名称" style="width:60%;" placeholder="提示：采购名称不允许超过30个字符" class="meeting" title="{{viewModel.purchaseBase.purchaseName}}" ng-model="viewModel.purchaseBase.purchaseName" />
                </div>
            </div>
            <div class="clearfix visible-xs-block"></div>

            <div class="col-xs-12 form-group">
                <label class="col-xs-6 col-sm-3 col-md-2 control-label" title="本次采购范围和内容" style="text-align:right;display:block;height:54px;line-height:54px;">本次采购范围和内容<span style="color:red;">*</span></label>
                <div class="col-xs-6 col-sm-6 col-md-10 form-group baseifo-input">
                    <textarea sog-valide-status="本次采购范围和内容" ng-model="viewModel.purchaseOfNotProject.purchaseContent" style="width:100%;height:54px;"></textarea>
                </div>
            </div>
            <div class="clearfix visible-xs-block"></div>

            <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                <label class="col-xs-6 control-label" title="直接委托理由" style="text-align:right">直接委托理由<span style="color:red;">*</span></label>
                <div class="col-xs-6 form-group baseifo-input">
                    <select sog-valide-status="直接委托理由" style="width:100%;" class="meeting" ng-model="viewModel.purchaseOfNotProject.directDelegationReasonCode" ng-options="p.code as p.name for p in viewModel.options.directDelegationReason" ng-selected="p.code == viewModel.purchaseOfNotProject.directDelegationReasonCode" ng-change="baseInfo.commissionReasonChange()">
                        <option value="">--请选择--</option>
                    </select>
                </div>
            </div>
            <div class="clearfix visible-xs-block"></div>

            <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                <label class="col-xs-6 control-label" title="本次拟采购金额（元）" style="text-align:right">本次拟采购金额（元）<span style="color:red;">*</span></label>
                <div class="col-xs-6 form-group baseifo-input">
                    <span>{{viewModel.purchaseBase.purchaseAmount | number:2}}</span>
                </div>
            </div>
            <div class="clearfix visible-xs-block"></div>
            <div class="clearfix"></div>
        </div>

        <!--使用成本中心-->
        <div select-usecostcenter data="viewModel.useCostCenterInfoList" expend-type="viewModel.purchaseBase.expenditureTypeCode" main-code="viewModel.mainCostCenterCode" readonly="false" isproject="true" isnotprojectdirect="true" isjdshop="viewModel.purchaseOfNotProject.directDelegationReasonCode==14" ng-show="viewModel.isUseCostCenter"></div>

        <h4 class="control-heading bg-info"><i class="glyphicon glyphicon-list-alt"></i> 委托信息<small><span style="color:red;">&nbsp;&nbsp;提示：下表每行对应一个合同，如需签订多个合同，请添加多行。</span></small></h4>
        <div ng-show="viewModel.purchaseOfNotProject.directDelegationReasonCode=='14' && viewModel.purchaseBase.purchaseAmount<=0">
            <table class="table table-striped table-bordered table-responsive">
                <thead>
                    <tr>
                        <th class="table-thead" style="text-align:center;width:5%;">序号</th>
                        <th class="table-thead" style="text-align:center;">
                            商品<br />
                            <span style="color: red; font-size: 75%;">（请一次性选择全部商品后提交，价格锁定七天，请尽快完成审批）</span>
                        </th>
                        <th class="table-thead" style="text-align:center;">直接委托金额</th>
                        <th class="table-thead" style="text-align:center;">直接委托供应商</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="item in viewModel.purchaseDelegationInfoList | orderBy:'sortNo'">
                        <td class="text-center">
                            {{$index+1}}
                        </td>
                        <td class="text-center">
                            <a style="color: blue;" ng-click="jdLogin();" class="ng-binding">选择</a>
                        </td>
                        <td class="text-center">
                            <div>
                                <span>{{item.delegationAmount | number:2}}</span>
                            </div>
                        </td>
                        <td class="text-center">
                            {{item.supplierName}}
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div ng-show="viewModel.purchaseOfNotProject.directDelegationReasonCode=='14' && viewModel.purchaseBase.purchaseAmount>0">
            <table class="table table-striped table-bordered table-responsive">
                <thead>
                    <tr>
                        <th class="table-thead" style="text-align:center;width:5%;">序号</th>
                        <th class="table-thead" style="text-align:center;">商品</th>
                        <th class="table-thead" style="text-align:center;">直接委托金额</th>
                        <th class="table-thead" style="text-align:center;">直接委托供应商</th>
                        <th class="table-thead" style="text-align:center;">订单跟踪</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="item in viewModel.purchaseDelegationInfoList | orderBy:'sortNo'">
                        <td class="text-center">
                            {{$index+1}}
                        </td>
                        <td class="text-center">
                            <a style="color: blue;" ng-click="showJdproducts()" class="ng-binding">查看</a>
                        </td>
                        <td class="text-center">
                            <span>{{item.delegationAmount|number:2}}</span>
                        </td>
                        <td class="text-center">
                            <a style="color:blue;" ng-click="checkSupplierDetails(item.supplierCode);" class="ng-binding">{{item.supplierName}}</a>
                        </td>
                        <td class="text-center">
                            {{item.jdOrderState}}
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div ng-show="viewModel.purchaseOfNotProject.directDelegationReasonCode!='14'" purchase-delegation-info data="viewModel.purchaseDelegationInfoList" readonly="false" opts="settings.delegationOpts"></div>
        <h4 class="control-heading bg-info"><i class="glyphicon glyphicon-list-alt"></i> 附件</h4>
        <div class="form-inline">
            <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                <label class="col-xs-6 control-label" title="直接委托报告" style="text-align:right;">直接委托报告</label>
                <div class="col-xs-6 form-group baseifo-input">
                    <div wf-uploader files="viewModel.purchaseOfNotProject.directCommissionedReportFile" opts="baseInfo.fileopts" ready="fileReady" read-only="fillFileReadOnly"></div>
                </div>
            </div>
            <div class="clearfix visible-xs-block"></div>

            <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                <label class="col-xs-6 control-label" title="其他附件" style="text-align:right;">其他附件</label>
                <div class="col-xs-6 form-group baseifo-input">
                    <div wf-uploader files="viewModel.purchaseOfNotProject.commissionedOtherFile" opts="baseInfo.fileopts" ready="fileReady" read-only="fillFileReadOnly"></div>
                </div>
            </div>
            <div class="clearfix visible-xs-block"></div>
            <div class="clearfix"></div>
        </div>
        <!--传阅-->
        <h4 class="control-heading bg-info"><i class="glyphicon glyphicon-list-alt"></i>传阅人</h4>
        <div class="form-inline">
            <div class="col-xs-12 col-sm-12 col-md-12 form-group">
                <label class="col-xs-6 col-sm-3 col-md-2 control-label " title="传阅人 ">传阅人</label>
                <div class="col-xs-6 col-sm-9 col-md-10 form-group baseifo-input" sog-valide-status="传阅人">
                    <span sog-ogu-input="viewModel.circularizePersons " opts="baseInfo.selectCheckBoxPeople"></span>
                </div>
            </div>
            <div class="clearfix visible-xs-block"></div>
            <div class="clearfix"></div>
        </div>

        <h4 class="control-heading bg-info"><i class="glyphicon glyphicon-list-alt"></i> 评论列表</h4>
        <div class="form-inline">
            <div class="form-inline">
                <span sog-comment="opinions"></span>
            </div>
            <div class="clearfix visible-xs-block"></div>
            <div class="clearfix"></div>
        </div>
        <!--其他审批流-->
        <div ng-show="viewModel.isUseCostCenter">
            <h4 class="control-heading bg-info">
                <i class="glyphicon glyphicon-list-alt"></i> 其他审批流
                <input type="button" style="margin-left:82%;font-weight:900;background-color:#d9edf7;" name="name" value="{{settings.spreadButtonName}}" class="btn" ng-click="settings.spreadInfoFn()" />
            </h4>
            <div class="form-inline" ng-show="settings.isSpreadInfo">
                <span sog-simple-opinions="viewModel.otherOpinions"></span>
                <div class="clearfix"></div>
            </div>
        </div>
        <!-- 审批意见列表-->
        <h4 class="control-heading bg-info" ng-show="isOpinionsShow"><i class="glyphicon glyphicon-list-alt"></i> 审批</h4>
        <div class="form-inline" ng-show="isOpinionsShow">
            <input wf-opinions opinions-opts="opinionOpts" opinions="opinions" predefined-opinions="predefinedOpinions" user-predefined-opinions="userPredefinedOpinions"
                   current-opinion="currentOpinion" url-base="/DirectCommissionedNotProjectApplicationWf" />
            <div class="clearfix"></div>
        </div>
    </div>
    <!--表单正文结束-->
    <!--页脚开始，不打印-->
    <div ng-include="'views/common/foot-copyright.html'"></div>
    <!--页脚结束-->
    <!--右侧通栏开始，不打印-->
    <div ng-include="'views/common/right-navigator.html'"></div>
</div>