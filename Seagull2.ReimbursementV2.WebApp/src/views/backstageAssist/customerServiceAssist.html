<div class="staff-service">
    <div class="container appil-container">
        <div class="page-header clearfix">
            <span>采购客服辅助工具</span>
        </div>
        <div class="form-inline clearfix">
            <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                <label class="col-xs-6 control-label">单据ResourceID</label>
                <div class="col-xs-6 form-group baseifo-input">
                    <input class="meeting" ng-model="viewModel.resourceID">
                </div>
            </div>
            <div class="col-xs-12 col-sm-6 col-md-8 form-group">
                (ResourceID怎么找，打开单据的流程跟踪，右下角找到
                <span style="color:red">流程信息</span>中的
                <span style="color:red">资源ID</span>即可)
            </div>
        </div>
        <div class="form-inline clearfix">
            <div class="baseifo-input">
                <button class="btn btn-primary btn-sm" ng-click="baseFn.searchType(1);baseFn.mutiApproval()">多审批查询</button>
                <button class="btn btn-primary btn-sm" ng-click="baseFn.searchType(2);baseFn.searchExpenditureType()">支出类型查看</button>
            </div>
        </div>
        <hr />

        <div ng-if="viewModel.searchType === 1">
            <h4 class="control-heading bg-info"><i class="glyphicon glyphicon-list-alt"></i>单据多审批查询</h4>
            <div class="form-inline clearfix">
                <div class="table-responsive" style="overflow: auto;">
                    <span ng-if="viewModel.mutiApprovalList != null && viewModel.mutiApprovalList.length > 0" style="color:palevioletred">单据名称：{{viewModel.mutiApprovalList[0].approvalTitle}}</span>
                    <table class="table table-hover table-bordered table-striped table-condensed">
                        <thead>
                            <tr>
                                <th class="text-center">多审批类型</th>
                                <th class="text-center">成本中心</th>
                                <th class="text-center">环节</th>
                                <th class="text-center">状态</th>
                                <th class="text-center">开始时间</th>
                                <th class="text-center">是否主流程</th>
                                <th class="text-center">重发轮次</th>
                                <th class="text-center">单据</th>
                                <th class="text-center">流程跟踪</th>
                                <th class="text-center">操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="text-left" ng-repeat="item in viewModel.mutiApprovalList">
                                <td>{{item.useApprovalTypeName}}</td>
                                <td>{{item.useCostCenterName}}</td>
                                <td>{{item.approveOccasionName}}</td>
                                <td>{{item.approvalStateName}}</td>
                                <td>{{item.createTime|date:'yyyy-MM-dd HH:mm'}}</td>
                                <td class="text-center">
                                    <span ng-if="item.resourceID === item.mainResourceID">是</span>
                                    <span ng-if="item.resourceID != item.mainResourceID">否</span>
                                </td>
                                <td class="text-center">{{item.sortNo}}</td>
                                <td class="text-center">
                                    <div open-extra-link extra-link="item.approvalUrl" extra-name="viewModel.openPagelable"></div>
                                </td>
                                <td class="text-center">
                                    <div open-extra-link extra-link="item.mainProcessID" extra-name="viewModel.openWorkFlowlable"></div>
                                </td>
                                <td class="text-center">
                                    <div ng-if="item.resourceID != item.mainResourceID">
                                        <button class="btn btn-primary btn-sm" ng-click="baseFn.abortWorkFlow(item)">作废分支</button>
                                    </div>
                                </td>
                            </tr>
                            <tr class="text-center" ng-if="viewModel.mutiApprovalList.length===0"><td colspan="10">暂无相关数据！</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div ng-if="viewModel.searchType === 2">
            <h4 class="control-heading bg-info"><i class="glyphicon glyphicon-list-alt"></i>单据支出类型查看</h4>
            <div class="col-xs-12 col-sm-12 col-md-12 form-group" ng-if="viewModel.expendInfo.successState == 0">
                无数据，请检查ResourceID是否正确
            </div>
            <div class="col-xs-12 col-sm-12 col-md-12 form-group" ng-if="viewModel.expendInfo.successState == 1">
                单据支出类型为本项目支持，请在原单据查看其他详情
            </div>
            <div ng-if="viewModel.expendInfo.successState == 2">
                <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                    <label class="col-xs-6 control-label text-right" title="支出类型">单据名称</label>
                    <div class="col-xs-6 form-group baseifo-input">
                        <div>{{viewModel.expendInfo.purchaseBase.purchaseName}}</div>
                    </div>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                    <label class="col-xs-6 control-label text-right" title="采购类别">采购类别</label>
                    <div class="col-xs-6 form-group baseifo-input">
                        <div>{{viewModel.expendInfo.purchaseBase.purchaseWayName}}</div>
                    </div>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                    <label class="col-xs-6 control-label text-right" title="业务类型">业务类型</label>
                    <div class="col-xs-6 form-group baseifo-input">
                        <div>{{viewModel.expendInfo.purchaseBase.purchaseBusinessTypeName}}</div>
                    </div>
                </div>
                <div class="clearfix"></div>
                <div class="col-xs-12 col-sm-6 col-md-4 form-group">
                    <label class="col-xs-6 control-label text-right" title="支出类型">支出类型</label>
                    <div class="col-xs-6 form-group baseifo-input">
                        <div>{{viewModel.expendInfo.purchaseBase.expenditureTypeName}}</div>
                    </div>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-4 form-group" ng-if="viewModel.expendInfo.purchaseBase.useProjectCode != null && viewModel.expendInfo.purchaseBase.useProjectCode != ''">
                    <label class="col-xs-6 control-label text-right" title="使用项目">使用项目:<span style="color:red">{{viewModel.expendInfo.purchaseBase.useProjectCode}}</span></label>
                    <div class="col-xs-6 form-group baseifo-input">
                        {{viewModel.expendInfo.purchaseBase.useProjectName}}
                    </div>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-4 form-group" ng-if="viewModel.expendInfo.purchaseBase.useStageAreaCode != null && viewModel.expendInfo.purchaseBase.useStageAreaName != ''">
                    <label class="col-xs-6 control-label text-right" title="使用期区">使用期区</label>
                    <div class="col-xs-6 form-group baseifo-input">
                        {{viewModel.expendInfo.purchaseBase.useStageAreaName}}
                    </div>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-4 form-group" ng-if="viewModel.expendInfo.purchaseBase.useChargeCompanyName != null && viewModel.expendInfo.purchaseBase.useChargeCompanyName != ''">
                    <label class="col-xs-6 control-label text-right" title="使用记账公司">使用记账公司</label>
                    <div class="col-xs-6 form-group baseifo-input">
                        {{viewModel.expendInfo.purchaseBase.useChargeCompanyName}}
                    </div>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-4 form-group" ng-if="viewModel.expendInfo.purchaseBase.useCostCenterName != null && viewModel.expendInfo.purchaseBase.useCostCenterName != ''">
                    <label class="col-xs-6 control-label text-right" title="使用成本中心">使用成本中心:<span style="color:red">{{viewModel.expendInfo.purchaseBase.useCostCenterCode}}</span></label>
                    <div class="col-xs-6 form-group baseifo-input">
                        {{viewModel.expendInfo.purchaseBase.useCostCenterName}}
                    </div>
                </div>
                <div class="clearfix"></div>
                <div class="col-xs-12 col-sm-12 col-md-12 form-group table-responsive" ng-if="viewModel.expendInfo.useCostCenterInfoList.length > 0">
                    <table class="table table-hover table-bordered table-striped table-condensed">
                        <thead>
                            <tr>
                                <th class="table-thead" style="text-align:center;">序号</th>
                                <th class="table-thead" style="text-align:center;">使用记账公司编码</th>
                                <th class="table-thead" style="text-align:center;">使用记账公司名称</th>
                                <th class="table-thead" style="text-align:center;">使用成本中心编码</th>
                                <th class="table-thead" style="text-align:center;">使用成本中心名称</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="item in viewModel.expendInfo.useCostCenterInfoList">
                                <td class="text-center">{{$index+1}}</td>
                                <td class="text-center">{{item.useChargeCompanyCode}}</td>
                                <td class="text-center">{{item.useChargeCompanyName}}</td>
                                <td class="text-center">{{item.useCostCenterCode}}</td>
                                <td class="text-center">{{item.useCostCenterName}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
